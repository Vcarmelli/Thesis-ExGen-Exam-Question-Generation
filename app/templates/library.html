{% extends 'layout/dashboard.html'%}

{% block title %}Library{% endblock %}

{% block content%}
<div class="dashboard-container">
    <header class="my-library-container">
        <h1>My Library</h1>
        <div class="btn-container">
            <a class="btn primary" href="{{ url_for('upload.upload_page')}}">
                <i class="fa-solid fa-plus"></i>Generate Exam</a>
            <a class="btn secondary" href="{{ url_for('key_upload.key_upload_page')}}">
                <i class="fa-solid fa-key"></i>Generate Keynotes</a>
        </div>
    </header>

    <div class="continue-card-container">
        
        <div class="blooms-counts">
            {% set icon = {
                'remember': 'fa-lightbulb',
                'understand': 'fa-brain',
                'apply': 'fa-comment-dots',
                'analyze': 'fa-magnifying-glass-chart', 
                'evaluate': 'fa-scale-balanced',
                'create': 'fa-pen-nib'
            } %}
            
            {% for bloom, count in counts.items() %}
            <div class="bloom {{ bloom }}">
                <div class="bloom-icons">
                    <i class="fa-solid {{ icon.get(bloom, 'fa-circle-question') }}"></i>
                    <button type="button" onclick="showBloomInfo('{{ bloom }}')">
                        <img src="../static/assets/up-right-arrow.png">
                    </button>
                </div>
                <div class="bloom-count">
                    <div class="card">
                        <h3>{{ count }}</h3>
                        <p>{{ bloom|capitalize }}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="two-column-section">
            <div class="recent-sets">
                <h2>Exams</h2>
                {% for set in question_sets %}
                <div class="continue-card set" data-set-id="{{ set.id }}">
                    <h3>{{ set.title }}</h3>
                    <span class="question-count">{{ set.question_count() }} questions</span>
                </div>
                {% endfor %}                 
            </div>
            <div class="recent-sets">
                <h2>Keynotes</h2>
                {% for keynote in keynotes %}
                <div class="continue-card keynote" data-keynote-id="{{ keynote.id }}">
                    <h3>{{ keynote.title }}</h3>
                    <span>{{ keynote.created_at.strftime('%Y-%m-%d') }}</span>
                        <!--<button class="delete-btn" onclick="deleteKeynote({{ keynote.id }})">Delete</button>-->
                </div>
                {% endfor %}  
            </div>
        </div>
    </div>

    <!-- BLOOM'S TAXONOMY INFORMATION MODALS -->
    <!-- Remember Modal -->
    <div id="rememberModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="red-line remember"></div>
                <div><button onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
            <div>
                <div class="input-container">
                    <div class="input-label">
                        <h1>Remember</h1>
                        <div class="bloom-info">
                            <p><strong>Remembering:</strong> Retrieving, recognizing, and recalling relevant knowledge from long‚Äêterm memory.</p>
                            <p>üí° Did you know? The "Remember" level is the foundation of Bloom's Taxonomy‚Äîwithout it, higher thinking levels can't exist! It's like the memory card of your brain, storing facts like the capital of France or the formula for water.</p>                   
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Understand Modal -->
    <div id="understandModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="red-line understand"></div>
                <div><button onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
            <div>
                <div class="input-container">
                    <div class="input-label">
                        <h1>Understand</h1>
                        <div class="bloom-info">
                            <p><strong>Understanding:</strong> Constructing meaning from oral, written, and graphic messages through interpreting, exemplifying, classifying, summarizing, inferring, comparing, and explaining.</p>
                            <p>üß† Fun Fact: Understanding is more than just memorizing‚Äîyou‚Äôre making sense of what you learn. When you explain a meme to someone and they get it, you just helped them reach this level!</p>                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Apply Modal -->
    <div id="applyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="red-line apply"></div>
                <div><button onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
            <div>
                <div class="input-container">
                    <div class="input-label">
                        <h1>Apply</h1>
                        <div class="bloom-info">
                            <p><strong>Applying:</strong> Carrying out or using a procedure for executing or implementing.</p>
                            <p>üí≠ Trivia: Application is about doing‚Äîturning knowledge into action. Whether you're solving a math problem or cooking a recipe you just learned, you're in Apply mode!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Analyze Modal -->
    <div id="analyzeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="red-line analyze"></div>
                <div><button onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
            <div>
                <div class="input-container">
                    <div class="input-label">
                        <h1>Analyze</h1>
                        <div class="bloom-info">
                            <p><strong>Analyzing:</strong> Breaking material into constituent parts and determining how the parts relate to one another and to an overall structure or purpose through differentiating, organizing, and attributing.</p>
                            <p>üîç Did you know? When Sherlock Holmes breaks down clues to solve a case, he's at the Analyze level. It‚Äôs all about breaking things apart to understand the whole better.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Evaluate Modal -->
    <div id="evaluateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="red-line evaluate"></div>
                <div><button onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
            <div>
                <div class="input-container">
                    <div class="input-label">
                        <h1>Evaluate</h1>
                        <div class="bloom-info">
                            <p><strong>Evaluating:</strong> Making judgments based on criteria and standards through checking and critiquing.</p>
                            <p>‚öñÔ∏è Fact Check: Evaluate is where you become a critic! Whether you‚Äôre judging a book, debating in class, or picking the best movie‚Äîthis is where your reasoning shines.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Modal -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="red-line create"></div>
                <div><button onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button></div>
            </div>
            <div>
                <div class="input-container">
                    <div class="input-label">
                        <h1>Create</h1>
                        <div class="bloom-info">
                            <p><strong>Creating:</strong> Putting elements together to form a coherent or functional whole; reorganizing elements into a new pattern or structure through generating, planning, or producing.</p>
                            <p>‚úíÔ∏è Did you know? ‚ÄúCreate‚Äù was actually added later during Bloom‚Äôs Taxonomy revision in 2001. It‚Äôs the peak‚Äîdesigning, inventing, composing. If you‚Äôre building something original, you‚Äôre already here!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    


    <script>
        let modal;
        function showBloomInfo(level) {
            modal = document.getElementById(`${level}Modal`);
            modal.style.display = "block";
        }
        function closeModal() {
            modal.style.display = "none";
        }


            document.addEventListener("DOMContentLoaded", function() {
                const bloomCards = document.querySelectorAll('.bloom');
                // Apply staggered animation delay
                bloomCards.forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('visible');
                    }, 100 * index);
                });

                const setCards = document.querySelectorAll('.continue-card.set');
                // Apply staggered animation delay
                setCards.forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('visible');
                    }, 100 * index);
                });

                const keynoteCards = document.querySelectorAll('.continue-card.keynote');
                // Apply staggered animation delay
                setCards.forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('visible');
                    }, 100 * index);
                });

                const cards = document.querySelectorAll('.continue-card');
                cards.forEach(function(card) {
                    card.addEventListener('click', function() {
                        const setId = card.getAttribute('data-set-id');
                        const keynoteId = card.getAttribute('data-keynote-id');
                        
                        if (setId) {
                            window.location.href = `/library/${setId}`;
                        } else if (keynoteId) {
                            window.location.href = `/library/keynote/${keynoteId}`;  // Adjust this URL to match your route for keynotes
                        }
                    });
                });
    });
        
    </script>

{% endblock %}

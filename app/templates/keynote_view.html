{% extends 'layout/dashboard.html'%}

{% block title %}{{ filename }} - Keynote{% endblock %}

{% block content %}
<div class="keynote-view-container">
    <div class="header-container">
        <a class="back-btn" href="{{ url_for('library.library_page') }}">
            <span class="material-symbols-outlined">arrow_back</span> Back to Library
        </a>
        <h1>{{ keynote.title }}</h1>
        <div class="meta-info">
            <p>Created: {{ keynote.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
            {% if keynote.file_path %}
            <p>Source: {{ keynote.file_path }}</p>
            {% endif %}
        </div>
    </div>

    <div class="keynote-content">
        {{ content | safe }}
    </div>

    <div class="action-buttons">
        <a class="export-btn" href="{{ url_for('key_export.export_keynotes_pdf') }}">Export to PDF</a>
        <a class="export-btn" href="{{ url_for('key_export.export_keynotes_docx') }}">Export to Word</a>
        <!--<button class="delete-btn" onclick="deleteKeynote({{ keynote.id }})">Delete</button>-->
    </div>
</div>

<script>
    function deleteKeynote(keynoteId) {
        if (!confirm('Are you sure you want to delete this keynote?')) {
            return;
        }
        
        fetch('/library/keynote/delete', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ keynoteId: keynoteId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message);
                // Redirect to library page after successful deletion
                window.location.href = "{{ url_for('library.library_page') }}";
            } else {
                alert(data.message || 'Failed to delete keynote');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while deleting the keynote');
        });
    }
</script>

<style>
    .keynote-view-container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .header-container {
        margin-bottom: 30px;
    }
    
    .back-btn {
        display: inline-flex;
        align-items: center;
        margin-bottom: 15px;
        color: #333;
        text-decoration: none;
        font-weight: 500;
    }
    
    .back-btn .material-symbols-outlined {
        margin-right: 5px;
    }
    
    .meta-info {
        color: #666;
        font-size: 0.9em;
        margin: 10px 0;
    }
    
    .keynote-content {
        background: whitesmoke;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
        color: #000000; /* Ensure text is black */
    }
    
    /* Force all text elements within keynote content to be black */
    .keynote-content p, 
    .keynote-content h1, 
    .keynote-content h2, 
    .keynote-content h3, 
    .keynote-content h4, 
    .keynote-content h5, 
    .keynote-content h6, 
    .keynote-content li, 
    .keynote-content span, 
    .keynote-content div {
        color: #000000 !important; /* Use !important to override any inline styles */
    }
    
    /* Target specifically highlighted elements if they exist */
    .keynote-content .highlight,
    .keynote-content [style*="background"] {
        color: #000000 !important;
        background-color: #f0f0f0 !important; /* Light gray background instead of blue */
    }
    
    .action-buttons {
        display: flex;
        gap: 15px;
        margin-top: 20px;
    }
    
    .export-btn, .delete-btn {
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: 500;
        cursor: pointer;
        text-decoration: none;
        text-align: center;
    }
    
    .export-btn {
        background-color: #4CAF50;
        color: white;
        border: none;
    }
    
    .delete-btn {
        background-color: #f44336;
        color: white;
        border: none;
    }

    .section-title {
        margin-top: 30px;
        margin-bottom: 15px;
        font-size: 1.5rem;
        color: #333;
        border-bottom: 2px solid #eee;
        padding-bottom: 8px;
    }

    .continue-card.keynote {
        display: flex;
        flex-direction: column;
        position: relative;
        padding-right: 50px; /* Space for the delete button */
    }

    .continue-card.keynote h3 {
        margin-bottom: 5px;
    }

    .continue-card.keynote span {
        font-size: 0.85rem;
        color: #666;
    }

    .delete-btn {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        background-color: #f44336;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 5px 10px;
        font-size: 0.8rem;
        cursor: pointer;
    }

    .delete-btn:hover {
        background-color: #d32f2f;
    }

    .no-content-message {
        padding: 15px;
        background-color: #f5f5f5;
        border-radius: 5px;
        text-align: center;
        color: #666;
        margin: 10px 0;
    }
</style>
{% endblock %}